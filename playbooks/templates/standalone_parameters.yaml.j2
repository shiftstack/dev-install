#vi:syntax=yaml

parameter_defaults:
  CloudName: {{ hostname }}.{{ clouddomain }}
  Debug: true
  DeploymentUser: {{ ansible_env.USER }}
  DnsServers:
{% for nameserver in network_info.dns %}
    - {{ nameserver }}
{% endfor %}
  # needed for vip & pacemaker
  KernelIpNonLocalBind: 1
  DockerInsecureRegistryAddress:
    - {{ public_api }}:8787
  # domain name used by the host
  CloudDomain: {{ clouddomain }}
  NeutronDnsDomain: {{ clouddomain }}
  NeutronBridgeMappings: {{ neutron_bridge_mappings }}
  NeutronFlatNetworks: {{ neutron_flat_networks }}
{% if sriov_interface is defined %}
  NeutronPhysicalDevMappings: "hostonly:{{ sriov_interface }}"
  NovaPCIPassthrough: {{sriov_nova_pci_passthrough | mandatory | to_json }}
{% endif %}
{% if kernel_args|length > 0 %}
  KernelArgs: "{{ kernel_args | join(' ') }}"
{% endif %}
{% if dpdk_kernel_args is defined %}
  IsolCpusList: "{{ dpdk_isol_cpus_list | mandatory }}"
  NovaComputeCpuDedicatedSet: "{{ dpdk_isol_cpus_list | mandatory }}"
  NovaComputeCpuSharedSet: "{{ dpdk_cpu_shared_set | mandatory }}"
  TunedProfileName: cpu-partitioning
{% endif %}
  StandaloneEnableRoutedNetworks: false
  StandaloneHomeDir: "{{ ansible_env.HOME }}"
  InterfaceLocalMtu: 1500
  SELinuxMode: permissive
  # For OSP17+:
  StandaloneNetworkConfigTemplate: "{{ ansible_env.HOME }}/dev-install_net_config.yaml"
  # For OSP16:
  StandaloneNetConfigOverride:
    network_config:
{% for member in net_config_json['network_config'] %}
      - {{ member }}
{% endfor %}
  OctaviaGenerateCerts: true
  OctaviaCaKeyPassphrase: "secrete"
  OctaviaAmphoraSshKeyFile: "{{ ansible_env.HOME }}/octavia.pub"
  OctaviaAmphoraImageFilename: "{{ ansible_env.HOME }}/amphora.qcow2"
  # We never want the node to reboot during tripleo deploy, but defer to later
  StandaloneExtraGroupVars:
    tripleo_kernel_defer_reboot: true
{% if ceph_enabled %}
  CephAnsibleDisksConfig:
    osd_scenario: lvm
    osd_objectstore: bluestore
    lvm_volumes:
      - data: data
        data_vg: vg_ceph
        db: db
        db_vg: vg_ceph
  CephAnsibleExtraConfig:
    cluster_network: {{ network_info.public_ipv4.network }}/{{ network_info.public_ipv4_cidr }}
    public_network: {{ network_info.public_ipv4.network }}/{{ network_info.public_ipv4_cidr }}
  CephPoolDefaultPgNum: 8
  CephPoolDefaultSize: 1
{% endif %}
{# note: keep this block at the very end #}
{% if extra_heat_params is defined %}
{% for key, value in extra_heat_params.items() %}
  {{ key }}: {{ value }}
{% endfor %}
{% endif %}
